<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>LJ: muVT TMMC &#8212; FEASST v0.2.2-2-gcfecc8aee4 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'v0.2.2-2-gcfecc8aee4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js"></script>
    <script type="text/javascript" src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Trimers: muVT TMMC with self assembly" href="1_lj_5_multi_site_README.html" />
    <link rel="prev" title="LJ: NVT MC" href="1_lj_2_nvt-mc_README.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1_lj_5_multi_site_README.html" title="Trimers: muVT TMMC with self assembly"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="1_lj_2_nvt-mc_README.html" title="LJ: NVT MC"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">FEASST v0.2.2-2-gcfecc8aee4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../testcase.html" accesskey="U">Test cases</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lj-muvt-tmmc">
<h1>LJ: muVT TMMC<a class="headerlink" href="#lj-muvt-tmmc" title="Permalink to this headline">¶</a></h1>
<div class="highlight-bash"><div class="highlight"><pre><span></span>testcase/1_lj/3_eostmmc
</pre></div>
</div>
<p>Compute the equation of state and coexistence of Lennard-Jones particles in the grand canonical ensemble.
Reproduce the results found in the NIST SRSW:</p>
<p><a class="reference external" href="http://www.nist.gov/mml/csd/informatics_research/srsw.cfm">http://www.nist.gov/mml/csd/informatics_research/srsw.cfm</a></p>
<p><a class="reference external" href="http://mmlapps.nist.gov/srs/LJ_PURE/eostmmc.htm">http://mmlapps.nist.gov/srs/LJ_PURE/eostmmc.htm</a></p>
<ul class="simple">
<li><a class="reference external" href="testcase/lj/srsw/eostmmc/1.2/run_*">testcase/lj/srsw/eostmmc/1.2/run_*</a> are example scripts to compile and run muvttmmclj.</li>
<li><code class="docutils literal"><span class="pre">lj.msdb.*</span></code> contain the results from the SRSW.</li>
<li><code class="docutils literal"><span class="pre">colMat</span></code> file with the macrostate probability distribution (<span class="math">\(ln\Pi\)</span>), potential energy and collection matrix</li>
</ul>
<p>To compare the results with the NIST SRSW:</p>
<ul class="simple">
<li>colMat columns 1:2 with <code class="docutils literal"><span class="pre">lj.msdb.t120.*.p_macro.dat</span></code></li>
<li>colMat columns 1:3 with <code class="docutils literal"><span class="pre">lj.msdb.t120.*.energy.dat</span></code></li>
</ul>
<p>Now, in order to compare coexistence properties of the LJ potential against the NIST SRSW:</p>
<p><a class="reference external" href="https://www.nist.gov/mml/csd/chemical-informatics-research-group/sat-tmmc-liquid-vapor-coexistence-properties-long-range">https://www.nist.gov/mml/csd/chemical-informatics-research-group/sat-tmmc-liquid-vapor-coexistence-properties-long-range</a></p>
<p>You will need to make use of histogram reweighting.</p>
<div class="section" id="histogram-reweighting">
<h2>Histogram reweighting<a class="headerlink" href="#histogram-reweighting" title="Permalink to this headline">¶</a></h2>
<p>For microcanonical partition function, <span class="math">\(\Omega(N,V,U)\)</span>, canonical, <span class="math">\(Q(N,V,T)\)</span> and grand canonical, <span class="math">\(\Xi(\mu, V, T)\)</span>, the probability to observe a state, <span class="math">\(\Pi\)</span> is given by</p>
<div class="math">
\[ \begin{align}\begin{aligned}\Pi(U) = \frac{\Omega(N,V,U)e^{-\beta U}}{Q(N,V,T)}\\ln\Pi(U) + \beta U = ln\Omega(N,V,U) + Const\\\Pi(N, U) = \frac{\Omega(N,V,U)e^{-\beta U + \beta \mu N}}{\Xi(\mu,V,T)}\\ln\Pi(N,U) + \beta U - \beta \mu N = ln\Omega(N,U,V) + Const\\ln\Pi_{expected}(N, U; \mu', V, T') = ln\Pi(N, U; \mu, V, T) -\beta` U + \beta U + (\beta` \mu` - \beta \mu)N + Const\\lnz(\mu, \beta) = \beta\mu - ln(Lambda(\beta)^3)\\ln\Pi_{expected}(N; \mu', V, T') = ln\Pi(N; \mu, V, T) + N(lnz` - lnz) + Const\end{aligned}\end{align} \]</div>
<p>For histogram reweighting, apply the equation above to the macrostate probability distribution, <span class="math">\(ln\Pi\)</span>, and renormalize, <span class="math">\(\sum \Pi = 1\)</span>.
When there are multiple peaks in <span class="math">\(ln\Pi\)</span> that do not change greatly with system size, this often corresponds to different macroscopic phases.
One chooses the minimum in <span class="math">\(ln\Pi\)</span> as the boundary between these two phases.
The two phases are at coexistence when the sum of their probabilities are equal.
Extensive properties, <span class="math">\(A\)</span> are obtained first as a series of canonical ensemble averages for each value of <span class="math">\(N\)</span>, and then post-processed as a function of <span class="math">\(lnz\)</span> as grand canonical ensemble averages, <span class="math">\(A(\mu,V,T) = \sum_N=0^{N_{max}} A(N,V,T) \Pi(N; \mu,V,T)\)</span></p>
<p>Example histogram reweighting tools are provided in <a class="reference external" href="tools/rw.cc">tools/rw.cc</a> and <a class="reference external" href="tools/rw.py">tools/rw.py</a>.
For C++, <code class="docutils literal"><span class="pre">cd</span> <span class="pre">tools</span></code> <code class="docutils literal"><span class="pre">./compile.sh</span> <span class="pre">rw</span></code> to make the <code class="docutils literal"><span class="pre">rw</span></code> executable.</p>
<p>To reweight <span class="math">\(ln\Pi\)</span> to different values of <span class="math">\(lnz\)</span>, use <code class="docutils literal"><span class="pre">tools/rw</span> <span class="pre">-i</span> <span class="pre">colMat</span> <span class="pre">-z</span> <span class="pre">[lnz</span> <span class="pre">value]</span></code> or <code class="docutils literal"><span class="pre">python</span> <span class="pre">tools/rw.py</span> <span class="pre">-i</span> <span class="pre">colMat</span> <span class="pre">-z</span> <span class="pre">[lnz</span> <span class="pre">value]</span></code> and the result is in <code class="docutils literal"><span class="pre">colMatrw.txtrw</span></code>.
If your <span class="math">\(ln\Pi\)</span> has multiple peaks, you can obtain saturation by <code class="docutils literal"><span class="pre">tools/rw</span> <span class="pre">-i</span> <span class="pre">colMat</span></code> or <code class="docutils literal"><span class="pre">python</span> <span class="pre">tools/rw.py</span> <span class="pre">-i</span> <span class="pre">colMat</span></code> and the resulting coexistence properties are printed and the reweighted <span class="math">\(lnz\)</span> is in <code class="docutils literal"><span class="pre">colMatrw</span></code>.</p>
</div>
<div class="section" id="what-chemical-potential-lnz-should-i-use">
<h2>What chemical potential (lnz) should I use?<a class="headerlink" href="#what-chemical-potential-lnz-should-i-use" title="Permalink to this headline">¶</a></h2>
<p>It almost doesn&#8217;t matter because you can reweight and the flat-histogram method gets over the barriers.
But you want to pick one that is closest to the properties of interest.
For example, if you want to study vapor-liquid coexistence then the closer you are to the actual coexistence lnz, the better.
Running short simulations will give you an idea if your simulation is favoring vapor too heavily (large peak for small N and monotonically decreasing <span class="math">\(ln\Pi\)</span>) or favoring liquid too heavily (large peak for large N and monotonically increasing <span class="math">\(ln\Pi\)</span>).
Plus, you can reweight your short simulation to see which lnz will get you closer to the region of interest.</p>
</div>
<div class="section" id="what-maximum-number-of-particles-should-i-use">
<h2>What maximum number of particles should I use?<a class="headerlink" href="#what-maximum-number-of-particles-should-i-use" title="Permalink to this headline">¶</a></h2>
<p>The maximum number of particles is tricky.
You are essentially choosing the truncation of the grand canonical average sum provided in the <a class="reference internal" href="#histogram-reweighting">Histogram reweighting</a> section above.
As N gets large, <span class="math">\(ln\Pi\)</span> gets very small and doesn&#8217;t significantly contribute to the grand canonical averages.
Thus, a simple rule of thumb is to say that once your <span class="math">\(ln\Pi\)</span> is about 20 units lower than the &#8220;peak&#8221; of interest in the macrostate distribution, then you no longer need values of N beyond this limit.
But you also have to remember than <span class="math">\(ln\Pi\)</span> changes when you are reweighting.
While it is more conservative to choose larger values of the maximum number of particles, it can also significantly increase the computational cost of the simulation.
Breaking the macrostate distribution into smaller pieces to perform the simulations helps, but you also want to make sure that your high density states are not simply stuck at some metastable state.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">README</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../testcase.html">Test cases</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_lj_1_ref-config_README.html">LJ: Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_lj_2_nvt-mc_README.html">LJ: NVT MC</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">LJ: muVT TMMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_lj_5_multi_site_README.html">Trimers: muVT TMMC with self assembly</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_lj_6_npt_README.html">LJ: NPT</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_jagla_1_ref-config_README.html">Jagla: Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_spce_1_ref-config_README.html">SPC/E: Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_spce_2_nvt-mc_README.html">SPC/E: NVT MC</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_spce_3_eostmmc_README.html">SPC/E: muVT WL-TMMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_hard_sphere_1_nvt-mc_README.html">Hard Sphere: NVT MC</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_yukawa_1_tmmc_README.html">LJ and Yukawa: muVT TMMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_square_well_1_semigrand_README.html">Square Well: Binary semigrand WLTMMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_square_well_2_floppy_box_README.html">Square Well: NVT with floppy box</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Application program interface (API)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently asked questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev.html">Guidelines for developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib.html">Authors and acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact and bug reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citation.html">Citation guide</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="1_lj_2_nvt-mc_README.html"
                        title="previous chapter">LJ: NVT MC</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="1_lj_5_multi_site_README.html"
                        title="next chapter">Trimers: muVT TMMC with self assembly</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1_lj_5_multi_site_README.html" title="Trimers: muVT TMMC with self assembly"
             >next</a> |</li>
        <li class="right" >
          <a href="1_lj_2_nvt-mc_README.html" title="LJ: NVT MC"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">FEASST v0.2.2-2-gcfecc8aee4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../testcase.html" >Test cases</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>