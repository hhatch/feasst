

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial &mdash; FEASST v0.8.0-1-gead8d12ca1-dirty documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css" type="text/css" />
  <link rel="stylesheet" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plugin" href="../plugin/README.html" />
    <link rel="prev" title="README" href="../README.html" />

	<!-- frame blocking -->
	<script type="text/javascript">
		if (top !=self) {
			top.location=self.location;
		}
	</script>

	<!-- NIST header and footer -->
	<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">



  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> FEASST
          

          
          </a>

          
            
            
              <div class="version">
                v0.8.0-1-gead8d12ca1-dirty
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../README.html">README</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation-and-interface">Installation and Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#canonical-ensemble-lennard-jones-monte-carlo">Canonical ensemble Lennard-Jones Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-tutorials">Additional tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plugin/README.html">Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../py/README.html">pyFEASST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../forcefield/README.html">Forcefield</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTACT.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ACKNOWLEDGEMENT.html">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CITATION.html">Citation guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">FEASST</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installation-and-interface">
<h2>Installation and Interface<a class="headerlink" href="#installation-and-interface" title="Permalink to this headline">¶</a></h2>
<div class="sidebar">
<p class="first sidebar-title">Python or C++?</p>
<p class="last">While the majority of FEASST users prefer the Python interface, FEASST is written almost entirely in C++.
Thus, both interfaces will be supported in the long term.</p>
</div>
<p>The installation is described in the <a class="reference internal" href="../README.html"><span class="doc">README</span></a>.
Although this tutorial will focus upon the python interface, FEASST may also be utilized as a C++ library.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although this tutorial focuses upon the Python interface, a comparison of <cite>tutorial/lj_brief.py</cite> with <cite>tutorial/lj_brief.cpp</cite> shows that the C++ and Python interfaces are nearly identical.
Thus Python tutorials are sufficient for learning the C++ library.</p>
</div>
</div>
<div class="section" id="canonical-ensemble-lennard-jones-monte-carlo">
<span id="lj-brief-tutorial"></span><h2>Canonical ensemble Lennard-Jones Monte Carlo<a class="headerlink" href="#canonical-ensemble-lennard-jones-monte-carlo" title="Permalink to this headline">¶</a></h2>
<p>The following simulation (tutorial/lj_brief.py) demonstrates the basics of FEASST.</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">feasst</span>

<span class="n">monte_carlo</span> <span class="o">=</span> <span class="n">feasst</span><span class="o">.</span><span class="n">MonteCarlo</span><span class="p">()</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">Configuration</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;cubic_box_length&quot;</span><span class="p">:</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span>
     <span class="s2">&quot;particle_type&quot;</span><span class="p">:</span> <span class="n">feasst</span><span class="o">.</span><span class="n">install_dir</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;/forcefield/data.lj&quot;</span><span class="p">})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeModelLJ</span><span class="p">()))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeLongRangeCorrections</span><span class="p">()))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeCriteriaMetropolis</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="s2">&quot;1.5&quot;</span><span class="p">,</span> <span class="s2">&quot;chemical_potential&quot;</span><span class="p">:</span> <span class="s2">&quot;1.&quot;</span><span class="p">})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeTrialTranslate</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;tunable_param&quot;</span><span class="p">:</span> <span class="s2">&quot;2.&quot;</span><span class="p">,</span> <span class="s2">&quot;tunable_target_acceptance&quot;</span><span class="p">:</span> <span class="s2">&quot;0.2&quot;</span><span class="p">})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeTuner</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;steps_per&quot;</span> <span class="p">:</span> <span class="s2">&quot;10000&quot;</span><span class="p">})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">seek_num_particles</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">steps_per</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeLog</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;steps_per&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">steps_per</span><span class="p">)})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeMovie</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;steps_per&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">steps_per</span><span class="p">),</span> <span class="s2">&quot;file_name&quot;</span> <span class="p">:</span> <span class="s2">&quot;movie.xyz&quot;</span><span class="p">})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeCheckEnergy</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;steps_per&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">steps_per</span><span class="p">),</span> <span class="s2">&quot;tolerance&quot;</span> <span class="p">:</span> <span class="s2">&quot;1e-8&quot;</span><span class="p">})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeRandomMT19937</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;seed&quot;</span> <span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">attempt</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e6</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="sidebar">
<p class="first sidebar-title"><a class="reference internal" href="../plugin/monte_carlo/doc/MonteCarlo.html#_CPPv3N6feasst10MonteCarloE" title="feasst::MonteCarlo"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">MonteCarlo</span></code></a> class diagram</p>
<p class="last">Top to bottom and left-to-right order is important.
For example, acceptance the <a class="reference internal" href="../plugin/monte_carlo/doc/Acceptance.html#_CPPv3N6feasst8CriteriaE" title="feasst::Criteria"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Criteria</span></code></a> should be defined before the <a class="reference internal" href="../plugin/monte_carlo/doc/Trial.html#_CPPv3N6feasst5TrialE" title="feasst::Trial"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Trials</span></code></a>.
Solid arrows show composition while dashed arrows show inheritance.</p>
</div>
<p><a class="reference internal" href="../plugin/monte_carlo/doc/MonteCarlo.html#_CPPv3N6feasst10MonteCarloE" title="feasst::MonteCarlo"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">MonteCarlo</span></code></a> contains <a class="reference internal" href="../plugin/system/doc/System.html#_CPPv3N6feasst6SystemE" title="feasst::System"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">System</span></code></a>, acceptance <a class="reference internal" href="../plugin/monte_carlo/doc/Acceptance.html#_CPPv3N6feasst8CriteriaE" title="feasst::Criteria"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Criteria</span></code></a>, <a class="reference internal" href="../plugin/monte_carlo/doc/Trial.html#_CPPv3N6feasst5TrialE" title="feasst::Trial"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Trials</span></code></a> and, finally, the usually infrequent <a class="reference internal" href="../plugin/monte_carlo/doc/Analyze.html#_CPPv3N6feasst7AnalyzeE" title="feasst::Analyze"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Analyze</span></code></a> and <a class="reference internal" href="../plugin/monte_carlo/doc/Modify.html#_CPPv3N6feasst6ModifyE" title="feasst::Modify"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Modify</span></code></a> between <a class="reference internal" href="../plugin/monte_carlo/doc/Trial.html#_CPPv3N6feasst5TrialE" title="feasst::Trial"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Trials</span></code></a>.
<a class="reference internal" href="../plugin/system/doc/System.html#_CPPv3N6feasst6SystemE" title="feasst::System"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">System</span></code></a> contains <a class="reference internal" href="../plugin/configuration/doc/Configuration.html#_CPPv3N6feasst13ConfigurationE" title="feasst::Configuration"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Configurations</span></code></a> and <a class="reference internal" href="../plugin/system/doc/Potential.html#_CPPv3N6feasst9PotentialE" title="feasst::Potential"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Potentials</span></code></a>.
<a class="reference internal" href="../plugin/configuration/doc/Configuration.html#_CPPv3N6feasst13ConfigurationE" title="feasst::Configuration"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Configurations</span></code></a> contain <a class="reference internal" href="../plugin/configuration/doc/Particle.html#_CPPv3N6feasst8ParticleE" title="feasst::Particle"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Particles</span></code></a> and the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Domain</span></code>.
The interaction <a class="reference internal" href="../plugin/system/doc/Potential.html#_CPPv3N6feasst9PotentialE" title="feasst::Potential"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Potentials</span></code></a> contain <a class="reference internal" href="../plugin/system/doc/Model.html#_CPPv3N6feasst5ModelE" title="feasst::Model"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Models</span></code></a> and <a class="reference internal" href="../plugin/system/doc/VisitModelInner.html#_CPPv3N6feasst10VisitModelE" title="feasst::VisitModel"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">VisitModels</span></code></a>.
The acceptance <a class="reference internal" href="../plugin/monte_carlo/doc/Acceptance.html#_CPPv3N6feasst8CriteriaE" title="feasst::Criteria"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Criteria</span></code></a> may be either <a class="reference internal" href="../plugin/monte_carlo/doc/CriteriaMetropolis.html#_CPPv3N6feasst18CriteriaMetropolisE" title="feasst::CriteriaMetropolis"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Metropolis</span></code></a> or <a class="reference internal" href="../plugin/flat_histogram/doc/CriteriaFlatHistogram.html#_CPPv3N6feasst21CriteriaFlatHistogramE" title="feasst::CriteriaFlatHistogram"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">flat</span> <span class="pre">histogram</span></code></a>.
This dependency is summarized in the following Figure and is useful to remember when initializing any <a class="reference internal" href="../plugin/monte_carlo/doc/MonteCarlo.html#_CPPv3N6feasst10MonteCarloE" title="feasst::MonteCarlo"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">MonteCarlo</span></code></a> simulation.</p>
<div class="figure">
<img alt="../_images/monte_carlo.svg" src="../_images/monte_carlo.svg" /></div>
<p>Thus, a first step in initializing <a class="reference internal" href="../plugin/monte_carlo/doc/MonteCarlo.html#_CPPv3N6feasst10MonteCarloE" title="feasst::MonteCarlo"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">MonteCarlo</span></code></a> is to add a <a class="reference internal" href="../plugin/configuration/doc/Configuration.html#_CPPv3N6feasst13ConfigurationE" title="feasst::Configuration"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Configuration</span></code></a> (or a <a class="reference internal" href="../plugin/system/doc/System.html#_CPPv3N6feasst6SystemE" title="feasst::System"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">System</span></code></a>).</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">Configuration</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;cubic_box_length&quot;</span><span class="p">:</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span>
     <span class="s2">&quot;particle_type&quot;</span><span class="p">:</span> <span class="n">feasst</span><span class="o">.</span><span class="n">install_dir</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;/forcefield/data.lj&quot;</span><span class="p">})))</span>
</pre></div>
</td></tr></table></div>
<div class="sidebar">
<p class="first sidebar-title"><a class="reference internal" href="../plugin/utils/doc/Arguments.html#_CPPv3N6feasst9ArgumentsE" title="feasst::Arguments"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Argument</span></code></a> types</p>
<p class="last">Although some type checking is built into <a class="reference internal" href="../plugin/utils/doc/Arguments.html#_CPPv3N6feasst9ArgumentsE" title="feasst::Arguments"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Arguments</span></code></a>, care must be taken to input strings which follow the documentation of the class, as found in the <a class="reference internal" href="../plugin/README.html"><span class="doc">Plugin</span></a>.</p>
</div>
<p>In this example, a simple cubic periodic box of length of 8 is defined with a single type of particle as described in <cite>forcefield/data.lj</cite>.
See <a class="reference internal" href="../forcefield/README.html"><span class="doc">Forcefield</span></a> for more information about the format of the data file, which is a LAMMPS-inspired file with some major differences.
<a class="reference internal" href="../plugin/utils/doc/Arguments.html#_CPPv3N6feasst9ArgumentsE" title="feasst::Arguments"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Arguments</span></code></a> are input by a dictionary of strings.
The SWIG C++ Python interface converts this Python dictionary of strings into a C++ std::map of strings via <cite>feasst.args(…)</cite>.</p>
<p>Initialization of the <a class="reference internal" href="../plugin/system/doc/Potential.html#_CPPv3N6feasst9PotentialE" title="feasst::Potential"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Potentials</span></code></a> proceeds as follows:</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeModelLJ</span><span class="p">()))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeLongRangeCorrections</span><span class="p">()))</span>
</pre></div>
</td></tr></table></div>
<div class="sidebar">
<p class="first sidebar-title">A FEASST convention</p>
<p class="last"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MakeModelLJ</span></code> creates a new <a class="reference internal" href="../plugin/system/doc/ModelLJ.html#_CPPv3N6feasst7ModelLJE" title="feasst::ModelLJ"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ModelLJ</span></code></a> object and returns a pointer to that object.
This serves two purposes involving C++11 smart pointers and brace enclosed initializer lists.</p>
</div>
<p>In this example, we introduce both the pair-wise <a class="reference internal" href="../plugin/system/doc/ModelLJ.html#_CPPv3N6feasst7ModelLJE" title="feasst::ModelLJ"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Lennard-Jones</span> <span class="pre">(LJ)</span> <span class="pre">model</span></code></a>, and also <a class="reference internal" href="../plugin/system/doc/LongRangeCorrections.html#_CPPv3N6feasst20LongRangeCorrectionsE" title="feasst::LongRangeCorrections"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">long-range</span> <span class="pre">corrections</span></code></a>, which approximately account for the cut off of the LJ potential by assuming a pair-wise radial distance distribution function of unity.
Also note that when creating pointers to FEASST dervied class objects, a convention is to use a helper function which appends the word <cite>Make</cite> onto the class name.</p>
<p>Initialization of the acceptance <a class="reference internal" href="../plugin/monte_carlo/doc/Acceptance.html#_CPPv3N6feasst8CriteriaE" title="feasst::Criteria"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Criteria</span></code></a> includes thermodynamic constraints such as temperature and chemical potential.</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeCriteriaMetropolis</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="s2">&quot;1.5&quot;</span><span class="p">,</span> <span class="s2">&quot;chemical_potential&quot;</span><span class="p">:</span> <span class="s2">&quot;1.&quot;</span><span class="p">})))</span>
</pre></div>
</td></tr></table></div>
<p>A <a class="reference internal" href="../plugin/monte_carlo/doc/TrialTranslate.html#_CPPv3N6feasst14TrialTranslateE" title="feasst::TrialTranslate"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TrialTranslate</span></code></a> is then introduced which attempts to translate a random particle by a random distance which is bound in each dimension by a <cite>tunable_param</cite>.
This parameter may be adjusted to obtain a desired acceptance ratio, <cite>tunable_target_acceptance</cite>, with the help of <a class="reference internal" href="../plugin/steppers/doc/Tuner.html#_CPPv3N6feasst5TunerE" title="feasst::Tuner"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Tuner</span></code></a>.</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeTrialTranslate</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;tunable_param&quot;</span><span class="p">:</span> <span class="s2">&quot;2.&quot;</span><span class="p">,</span> <span class="s2">&quot;tunable_target_acceptance&quot;</span><span class="p">:</span> <span class="s2">&quot;0.2&quot;</span><span class="p">})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeTuner</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;steps_per&quot;</span> <span class="p">:</span> <span class="s2">&quot;10000&quot;</span><span class="p">})))</span>
</pre></div>
</td></tr></table></div>
<p>With the help of <a class="reference internal" href="../plugin/monte_carlo/doc/TrialTranslate.html#_CPPv3N6feasst14TrialTranslateE" title="feasst::TrialTranslate"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TrialTranslate</span></code></a>, we can now initialize the number of particles.</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">monte_carlo</span><span class="o">.</span><span class="n">seek_num_particles</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">While <a class="reference internal" href="../plugin/monte_carlo/doc/MonteCarlo.html#_CPPv3N6feasst10MonteCarlo18seek_num_particlesEKi" title="feasst::MonteCarlo::seek_num_particles"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">seek_num_particles</span></code></a> appears simple, care must be taken for when to perform this step.
A grand canonical simulation is performed here, which is why chemical potential was input for <a class="reference internal" href="../plugin/monte_carlo/doc/Acceptance.html#_CPPv3N6feasst8CriteriaE" title="feasst::Criteria"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Criteria</span></code></a>.
This function is likely to change in upcoming versions to reflect more nuanced features which are out of the scope of this tutorial.</p>
</div>
<p>Additional <a class="reference internal" href="../plugin/monte_carlo/doc/Analyze.html#_CPPv3N6feasst7AnalyzeE" title="feasst::Analyze"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Analyze</span></code></a> or <a class="reference internal" href="../plugin/monte_carlo/doc/Modify.html#_CPPv3N6feasst6ModifyE" title="feasst::Modify"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Modify</span></code></a> may be added at any time to perform some task contingent upon the number of attempted trials.</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">steps_per</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeLog</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;steps_per&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">steps_per</span><span class="p">)})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeMovie</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;steps_per&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">steps_per</span><span class="p">),</span> <span class="s2">&quot;file_name&quot;</span> <span class="p">:</span> <span class="s2">&quot;movie.xyz&quot;</span><span class="p">})))</span>
<span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeCheckEnergy</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;steps_per&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">steps_per</span><span class="p">),</span> <span class="s2">&quot;tolerance&quot;</span> <span class="p">:</span> <span class="s2">&quot;1e-8&quot;</span><span class="p">})))</span>
</pre></div>
</td></tr></table></div>
<p>In this example, <a class="reference internal" href="../plugin/steppers/doc/Log.html#_CPPv3N6feasst3LogE" title="feasst::Log"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Log</span></code></a> outputs the current status of the trials, <a class="reference internal" href="../plugin/steppers/doc/Movie.html#_CPPv3N6feasst5MovieE" title="feasst::Movie"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Movie</span></code></a> outputs the configuration, and <a class="reference internal" href="../plugin/steppers/doc/CheckEnergy.html#_CPPv3N6feasst11CheckEnergyE" title="feasst::CheckEnergy"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">CheckEnergy</span></code></a> asserts that the optimized energy calculations match the unoptimized ones.</p>
<p>Finally, a random number generator using the C++ implementation of the Mersenne Twister is seeded by the date.</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">monte_carlo</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">MakeRandomMT19937</span><span class="p">(</span><span class="n">feasst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;seed&quot;</span> <span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">})))</span>
</pre></div>
</td></tr></table></div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Care must be taken not to run two identical simulations at the same second on an HPC node using the date, or they will have the same seed and may not diverge.
Instead, consider using a <cite>thread safe</cite> random number generator to seed the simulations.</p>
</div>
<p>The simulation is finally run for a number of trial attempts.</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">monte_carlo</span><span class="o">.</span><span class="n">attempt</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e6</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>Run the simulation on the command line and you should see something similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[user@host]$ feasst/py/run.sh feasst/tutorial/lj_brief.py
...
energy attempt TrialTranslate tunable
...
-99.7639 980000 0.20339 0.650287
-127.211 990000 0.186441 0.617773
-127.339 1000000 0.152542 0.586884
</pre></div>
</div>
<p>Because the <a class="reference internal" href="../plugin/steppers/doc/Log.html#_CPPv3N6feasst3LogE" title="feasst::Log"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Log</span></code></a> did not include <cite>file_name</cite> in its <a class="reference internal" href="../plugin/utils/doc/Arguments.html#_CPPv3N6feasst9ArgumentsE" title="feasst::Arguments"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Arguments</span></code></a>, it will use standard output to screen.
Thus, you should observe a column of energies, numbers of trials, translation trial acceptance and the value of the tunable parameter.
You should also find the <cite>movie.xyz</cite> trajectory file printed by <a class="reference internal" href="../plugin/steppers/doc/Movie.html#_CPPv3N6feasst5MovieE" title="feasst::Movie"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Movie</span></code></a> with an automatically-generated <cite>movie.xyz.vmd</cite> file for use with VMD (e.g., <cite>vmd -e movie.xyz.vmd</cite>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Did this tutorial work as expected?
Did you find any inconsistencies or have any comments?
Please <a class="reference internal" href="../CONTACT.html"><span class="doc">Contact</span></a> us.
Any feedback is appreciated!</p>
</div>
</div>
<div class="section" id="additional-tutorials">
<h2>Additional tutorials<a class="headerlink" href="#additional-tutorials" title="Permalink to this headline">¶</a></h2>
<p>After completing this basic tutorial, check out the tutorials specific to each <a class="reference internal" href="../plugin/README.html"><span class="doc">Plugin</span></a>.
For example, see the tutorials of the <a class="reference internal" href="../plugin/system/README.html"><span class="doc">System</span></a>, <a class="reference internal" href="../plugin/monte_carlo/README.html"><span class="doc">Monte Carlo</span></a> and <a class="reference internal" href="../plugin/flat_histogram/README.html"><span class="doc">Flat histogram</span></a> plugins.
To complete the tutorials, investigate the contents and comments contained within each script present in the <cite>plugin/&lt;name&gt;/tutorial</cite> directory.
Then run the scripts and see that they produce the expected results.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../plugin/README.html" class="btn btn-neutral float-right" title="Plugin" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../README.html" class="btn btn-neutral" title="README" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js"></script>
        <script type="text/javascript" src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js"></script>
        <script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
        <script type="text/javascript" src="../_static/leave_notice.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>