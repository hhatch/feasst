

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Grand canonical ensemble transition-matrix Monte Carlo &mdash; FEASST v0.19.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js"></script>
        <script src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
        <script src="../../../_static/leave_notice.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Analysis of a one-phase (supercritical) simulation" href="tutorial_2_reweight_supercritical.html" />
    <link rel="prev" title="Analysis of a hard sphere simulation" href="tutorial_10_hs.html" />

	<!-- frame blocking -->
	<script type="text/javascript">
		if (top !=self) {
			top.location=self.location;
		}
	</script>

	<!-- NIST header and footer -->
	<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> FEASST
          

          
          </a>

          
            
            
              <div class="version">
                v0.19.0
              </div>
            
          

          

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../README.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../README.html">Plugins</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../threads/README.html">Threads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../utils/README.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/README.html">Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../configuration/README.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../system/README.html">System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../monte_carlo/README.html">Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../example/README.html">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/README.html">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../steppers/README.html">Steppers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../README.html">Flat histogram</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../README.html#tutorial">Tutorial</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="tutorial_10_hs.html">Analysis of a hard sphere simulation</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Grand canonical ensemble transition-matrix Monte Carlo</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial_2_reweight_supercritical.html">Analysis of a one-phase (supercritical) simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial_3_reweight_phase_separation.html">Analysis of a two-phase (phase separated) simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial_4_spce_gcmc.html">Grand canonical ensemble transition-matrix Monte Carlo with SPC/E</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial_5_lj_gcmc_parallel.html">Parallelize a flat histogram simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial_6_rpm_gcmc.html">Grand canonical ensemble transition-matrix Monte Carlo with RPM</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial_9_ideal_gas.html">Ideal gas equation of state using grand canonical ensemble transition-matrix Monte Carlo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#tools">Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#feasst-plugin-dependencies">FEASST plugin dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../patch/README.html">Patch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mayer/README.html">Mayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../xtc/README.html">XTC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chain/README.html">Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../shape/README.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../confinement/README.html">Confinement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../charge/README.html">Charge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../opt_lj/README.html">Optimized Lennard-Jones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cluster/README.html">Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../egce/README.html">Expanded Grand Canonical Ensemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../morph/README.html">Morph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../beta_expanded/README.html">Beta expanded</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../prefetch/README.html">Prefetch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../py/README.html">pyFEASST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../forcefield/README.html">Forcefield and Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../CONTACT.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ACKNOWLEDGEMENT.html">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../CITATION.html">Citation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">FEASST</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <header class="nist-header" id="nist-header" role="banner">

  <a href="https://www.nist.gov/" title="National Institute of Standards and Technology" class="nist-header__logo-link" rel="home">
    <svg aria-hidden="true" class="nist-header__logo-icon" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="32" viewBox="0 0 24 32">
      <path d="M20.911 5.375l-9.482 9.482 9.482 9.482c0.446 0.446 0.446 1.161 0 1.607l-2.964 2.964c-0.446 0.446-1.161 0.446-1.607 0l-13.25-13.25c-0.446-0.446-0.446-1.161 0-1.607l13.25-13.25c0.446-0.446 1.161-0.446 1.607 0l2.964 2.964c0.446 0.446 0.446 1.161 0 1.607z"></path>
    </svg>
    <svg class="nist-header__logo-image" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="-237 385.7 109.7 29.3">
      <title>National Institute of Standards and Technology</title>
      <g>
        <path class="st0" d="M-231,415h-6v-23.1c0,0,0-4.4,4.4-5.8c4-1.3,6.6,1.3,6.6,1.3l19.7,21.3c1,0.6,1.4,0,1.4-0.6v-22h6.1V409
          c0,1.9-1.6,4.4-4,5.3c-2.4,0.9-4.9,0.9-7.9-1.7l-18.5-20c-0.5-0.5-1.8-0.6-1.8,0.4L-231,415L-231,415z"/>
        <path class="st0" d="M-195,386.1h6.1v20.7c0,2.2,1.9,2.2,3.6,2.2h26.8c1.1,0,2.4-1.3,2.4-2.7c0-1.4-1.3-2.8-2.5-2.8H-176
          c-3,0.1-9.2-2.7-9.2-8.5c0-7.1,5.9-8.8,8.6-9h49.4v6.1h-12.3V415h-6v-22.9h-30.2c-2.9-0.2-4.9,4.7-0.2,5.4h18.6
          c2.8,0,7.4,2.4,7.5,8.4c0,6.1-3.6,9-7.5,9H-185c-4.5,0-6.2-1.1-7.8-2.5c-1.5-1.5-1.7-2.3-2.2-5.3L-195,386.1
          C-194.9,386.1-195,386.1-195,386.1z"/>
      </g>
    </svg>
  </a>

</header>

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../README.html">Plugins</a> &raquo;</li>
        
          <li><a href="../README.html">Flat histogram</a> &raquo;</li>
        
      <li>Grand canonical ensemble transition-matrix Monte Carlo</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Grand-canonical-ensemble-transition-matrix-Monte-Carlo">
<h1>Grand canonical ensemble transition-matrix Monte Carlo<a class="headerlink" href="#Grand-canonical-ensemble-transition-matrix-Monte-Carlo" title="Permalink to this headline">¶</a></h1>
<p>In this example, flat histogram methods are employed for a small macrostate range from 0 to 5 particles. To begin, the system is initialized with the minimum number of particles by setting Metropolis acceptance criteria with favorable conditions for adding particles. The Metropolis criteria are then replaced with the flat histogram criteria. At this point, typical analysis from the previous tutorials are added. In addition, we also add checkpoint files, criteria status, and average energy of a
given macrostate. Finally, the simulation is run until the requested number of iterations of the flat histogram algorithm are complete.</p>
<p>A small macrostate range allows the simulation to run quickly with good sampling, and thus it is an ideal starting point to test the simulations. To begin, read the previous SRSW values from file for comparison.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">feasst</span> <span class="k">as</span> <span class="nn">fst</span>

<span class="n">srsw_file</span> <span class="o">=</span> <span class="n">fst</span><span class="o">.</span><span class="n">install_dir</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;/plugin/flat_histogram/test/data/stat150.csv&quot;</span>
<span class="n">ln_prob_srsw</span> <span class="o">=</span> <span class="n">fst</span><span class="o">.</span><span class="n">LnProbability</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">srsw_file</span><span class="p">)[</span><span class="s2">&quot;lnPI&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">6</span><span class="p">])</span>
<span class="n">ln_prob_srsw</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span> <span class="c1"># normalize to account for a smaller macrostate range</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ln_prob_srsw</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ln_prob_srsw&quot;</span><span class="p">})</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;ln_prob_srsw_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.04</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;u_srsw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">srsw_file</span><span class="p">)[</span><span class="s2">&quot;energy&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;u_srsw_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">srsw_file</span><span class="p">)[</span><span class="s2">&quot;energystd&quot;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ln_prob_srsw</th>
      <th>ln_prob_srsw_std</th>
      <th>u_srsw</th>
      <th>u_srsw_std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-18.707570</td>
      <td>0.04</td>
      <td>-2.312265e-10</td>
      <td>6.689238e-10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-14.037373</td>
      <td>0.04</td>
      <td>-6.057402e-04</td>
      <td>6.709198e-10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-10.050312</td>
      <td>0.04</td>
      <td>-3.057422e-02</td>
      <td>9.649147e-06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-6.458921</td>
      <td>0.04</td>
      <td>-8.992832e-02</td>
      <td>1.387472e-04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-3.145637</td>
      <td>0.04</td>
      <td>-1.784571e-01</td>
      <td>3.315245e-05</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.045677</td>
      <td>0.04</td>
      <td>-2.961920e-01</td>
      <td>1.348791e-05</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">pyfeasst</span>

<span class="k">def</span> <span class="nf">run_sample_lj_tm_mc</span><span class="p">(</span><span class="n">checkpoint_file_name</span><span class="p">):</span>
    <span class="n">monte_carlo</span> <span class="o">=</span> <span class="n">fst</span><span class="o">.</span><span class="n">MonteCarlo</span><span class="p">()</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeConfiguration</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;cubic_box_length&quot;</span><span class="p">:</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span>
                                       <span class="s2">&quot;particle_type0&quot;</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">install_dir</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;/forcefield/lj.fstprt&quot;</span><span class="p">})))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakePotential</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeLennardJones</span><span class="p">()))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakePotential</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeLongRangeCorrections</span><span class="p">()))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeThermoParams</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">1.5</span><span class="p">),</span> <span class="s2">&quot;chemical_potential&quot;</span><span class="p">:</span> <span class="s2">&quot;-2.352321&quot;</span><span class="p">})))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeFlatHistogram</span><span class="p">(</span>
        <span class="n">fst</span><span class="o">.</span><span class="n">MakeMacrostateNumParticles</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span><span class="p">}))),</span>
        <span class="n">fst</span><span class="o">.</span><span class="n">MakeTransitionMatrix</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;min_sweeps&quot;</span><span class="p">:</span> <span class="s2">&quot;50&quot;</span><span class="p">}))))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeTrialTranslate</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="s2">&quot;0.25&quot;</span><span class="p">,</span> <span class="s2">&quot;tunable_param&quot;</span><span class="p">:</span> <span class="s2">&quot;1.&quot;</span><span class="p">})))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeTrialTransfer</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;particle_type&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">})))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeLogAndMovie</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;steps_per&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1e5</span><span class="p">),</span> <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;lj&quot;</span><span class="p">})))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeCheckEnergyAndTune</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;steps_per&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1e5</span><span class="p">),</span> <span class="s2">&quot;tolerance&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">)})))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeCriteriaUpdater</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;steps_per&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)})))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeCriteriaWriter</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;steps_per&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1e5</span><span class="p">),</span> <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;lj_fh.txt&quot;</span><span class="p">})))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeEnergy</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;lj_en.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;steps_per_update&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;steps_per_write&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1e5</span><span class="p">),</span> <span class="s2">&quot;multistate&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">})))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">MakeCheckpoint</span><span class="p">(</span><span class="n">fst</span><span class="o">.</span><span class="n">args</span><span class="p">({</span><span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="n">checkpoint_file_name</span><span class="p">,</span> <span class="s2">&quot;num_hours&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">})))</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">TestFlatHistogramLJ</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test flat histogram grand canonical ensemble Monte Carlo simulations&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">test_serial_5max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compare the free energies and potential energies with the NIST SRSW</span>
<span class="sd">        https://www.nist.gov/programs-projects/nist-standard-reference-simulation-website</span>
<span class="sd">        https://mmlapps.nist.gov/srs/LJ_PURE/eostmmc.htm</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># To emulate post-processing, obtain monte_carlo from checkpoint file</span>
        <span class="n">checkpoint_file_name</span><span class="o">=</span><span class="s1">&#39;checkpoint.txt&#39;</span>
        <span class="n">run_sample_lj_tm_mc</span><span class="p">(</span><span class="n">checkpoint_file_name</span><span class="p">)</span>
        <span class="n">monte_carlo</span> <span class="o">=</span> <span class="n">fst</span><span class="o">.</span><span class="n">MonteCarlo</span><span class="p">()</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">pyfeasst</span><span class="o">.</span><span class="n">read_checkpoint</span><span class="p">(</span><span class="n">checkpoint_file_name</span><span class="p">))</span>

        <span class="c1"># To compare with previous values, make a deep copy of the FlatHistogram derived class</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">fst</span><span class="o">.</span><span class="n">FlatHistogram</span><span class="p">(</span><span class="n">monte_carlo</span><span class="o">.</span><span class="n">criteria</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lnpi energy&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">num_states</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ln_prob_srsw&quot;</span><span class="p">][</span><span class="n">macro</span><span class="p">],</span>
                <span class="n">criteria</span><span class="o">.</span><span class="n">bias</span><span class="p">()</span><span class="o">.</span><span class="n">ln_prob</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">macro</span><span class="p">),</span>
                <span class="n">delta</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ln_prob_srsw_std&quot;</span><span class="p">][</span><span class="n">macro</span><span class="p">])</span>
            <span class="n">energy_analyzer</span> <span class="o">=</span> <span class="n">monte_carlo</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">monte_carlo</span><span class="o">.</span><span class="n">num_analyzers</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">energy_accumulator</span> <span class="o">=</span> <span class="n">energy_analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span><span class="o">.</span><span class="n">accumulator</span><span class="p">()</span>
            <span class="n">stdev</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;u_srsw_std&quot;</span><span class="p">][</span><span class="n">macro</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">energy_accumulator</span><span class="o">.</span><span class="n">block_stdev</span><span class="p">()</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
            <span class="c1">#print(criteria.bias().ln_prob().value(macro), energy_accumulator.average())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;u_srsw&quot;</span><span class="p">][</span><span class="n">macro</span><span class="p">],</span>
                <span class="n">energy_accumulator</span><span class="o">.</span><span class="n">average</span><span class="p">(),</span>
                <span class="n">delta</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="n">stdev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Note: any line starting with % is only to be used with ipynb</span>
<span class="o">%</span><span class="k">time</span>
<span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">exit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
test_serial_5max (__main__.TestFlatHistogramLJ)
Compare the free energies and potential energies with the NIST SRSW ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 4 µs, sys: 2 µs, total: 6 µs
Wall time: 11.4 µs
lnpi energy
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
ok

----------------------------------------------------------------------
Ran 1 test in 11.283s

OK
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;unittest.main.TestProgram at 0x7ff7a676e430&gt;
</pre></div></div>
</div>
<p>A number of files should also have been created. If the flat histogram method is sampling perfectly, the simulation performs a random walk along the macrostate. For larger ranges of macrostates, or for more difficult sampling cases, monitoring the macrostate can help you determine what conditions are preventing convergence. For example, a plot of the macrostate as a function of the number of attempts may look like the following:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;lj.txt&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>volume</th>
      <th>p0</th>
      <th>beta</th>
      <th>state</th>
      <th>energy</th>
      <th>attempt</th>
      <th>TrialTranslate</th>
      <th>tunable</th>
      <th>TrialAdd</th>
      <th>TrialRemove</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>512</td>
      <td>5</td>
      <td>0.666667</td>
      <td>5</td>
      <td>-4.358780e-01</td>
      <td>100000</td>
      <td>0.943786</td>
      <td>1.00000</td>
      <td>0.044366</td>
      <td>0.044385</td>
    </tr>
    <tr>
      <th>1</th>
      <td>512</td>
      <td>3</td>
      <td>0.666667</td>
      <td>3</td>
      <td>-1.127030e-02</td>
      <td>200000</td>
      <td>0.960806</td>
      <td>1.05000</td>
      <td>0.694640</td>
      <td>0.708879</td>
    </tr>
    <tr>
      <th>2</th>
      <td>512</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0</td>
      <td>-2.802770e-15</td>
      <td>300000</td>
      <td>0.971389</td>
      <td>1.10250</td>
      <td>0.807342</td>
      <td>0.967410</td>
    </tr>
    <tr>
      <th>3</th>
      <td>512</td>
      <td>2</td>
      <td>0.666667</td>
      <td>2</td>
      <td>-2.422960e-03</td>
      <td>400000</td>
      <td>0.971608</td>
      <td>1.15763</td>
      <td>0.812283</td>
      <td>0.972804</td>
    </tr>
    <tr>
      <th>4</th>
      <td>512</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0</td>
      <td>2.021060e-15</td>
      <td>500000</td>
      <td>0.970708</td>
      <td>1.21551</td>
      <td>0.814323</td>
      <td>0.972938</td>
    </tr>
    <tr>
      <th>5</th>
      <td>512</td>
      <td>1</td>
      <td>0.666667</td>
      <td>1</td>
      <td>-6.057400e-04</td>
      <td>600000</td>
      <td>0.967800</td>
      <td>1.27628</td>
      <td>0.815516</td>
      <td>0.975552</td>
    </tr>
    <tr>
      <th>6</th>
      <td>512</td>
      <td>1</td>
      <td>0.666667</td>
      <td>1</td>
      <td>-6.057400e-04</td>
      <td>700000</td>
      <td>0.970213</td>
      <td>1.34010</td>
      <td>0.816728</td>
      <td>0.973423</td>
    </tr>
    <tr>
      <th>7</th>
      <td>512</td>
      <td>4</td>
      <td>0.666667</td>
      <td>4</td>
      <td>-9.691840e-03</td>
      <td>800000</td>
      <td>0.965229</td>
      <td>1.40710</td>
      <td>0.808667</td>
      <td>0.971636</td>
    </tr>
    <tr>
      <th>8</th>
      <td>512</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0</td>
      <td>-9.192950e-16</td>
      <td>900000</td>
      <td>0.965878</td>
      <td>1.47746</td>
      <td>0.811482</td>
      <td>0.972543</td>
    </tr>
    <tr>
      <th>9</th>
      <td>512</td>
      <td>1</td>
      <td>0.666667</td>
      <td>1</td>
      <td>-6.057400e-04</td>
      <td>1000000</td>
      <td>0.965261</td>
      <td>1.55133</td>
      <td>0.814702</td>
      <td>0.974363</td>
    </tr>
    <tr>
      <th>10</th>
      <td>512</td>
      <td>3</td>
      <td>0.666667</td>
      <td>3</td>
      <td>-9.914610e-01</td>
      <td>1100000</td>
      <td>0.966295</td>
      <td>1.62889</td>
      <td>0.808995</td>
      <td>0.973799</td>
    </tr>
    <tr>
      <th>11</th>
      <td>512</td>
      <td>5</td>
      <td>0.666667</td>
      <td>5</td>
      <td>-7.500420e-02</td>
      <td>1200000</td>
      <td>0.964479</td>
      <td>1.71034</td>
      <td>0.811765</td>
      <td>0.973286</td>
    </tr>
    <tr>
      <th>12</th>
      <td>512</td>
      <td>4</td>
      <td>0.666667</td>
      <td>4</td>
      <td>-1.878110e-02</td>
      <td>1300000</td>
      <td>0.964260</td>
      <td>1.79586</td>
      <td>0.810563</td>
      <td>0.974759</td>
    </tr>
    <tr>
      <th>13</th>
      <td>512</td>
      <td>1</td>
      <td>0.666667</td>
      <td>1</td>
      <td>-6.057400e-04</td>
      <td>1400000</td>
      <td>0.964481</td>
      <td>1.88565</td>
      <td>0.809076</td>
      <td>0.973104</td>
    </tr>
    <tr>
      <th>14</th>
      <td>512</td>
      <td>2</td>
      <td>0.666667</td>
      <td>2</td>
      <td>-2.422960e-03</td>
      <td>1500000</td>
      <td>0.963575</td>
      <td>1.97993</td>
      <td>0.813165</td>
      <td>0.974213</td>
    </tr>
    <tr>
      <th>15</th>
      <td>512</td>
      <td>5</td>
      <td>0.666667</td>
      <td>5</td>
      <td>-1.514350e-02</td>
      <td>1600000</td>
      <td>0.960274</td>
      <td>2.07893</td>
      <td>0.812094</td>
      <td>0.974442</td>
    </tr>
    <tr>
      <th>16</th>
      <td>512</td>
      <td>2</td>
      <td>0.666667</td>
      <td>2</td>
      <td>-2.422960e-03</td>
      <td>1700000</td>
      <td>0.962626</td>
      <td>2.18287</td>
      <td>0.811691</td>
      <td>0.974380</td>
    </tr>
    <tr>
      <th>17</th>
      <td>512</td>
      <td>5</td>
      <td>0.666667</td>
      <td>5</td>
      <td>-6.550770e-02</td>
      <td>1800000</td>
      <td>0.958405</td>
      <td>2.29202</td>
      <td>0.811169</td>
      <td>0.974205</td>
    </tr>
    <tr>
      <th>18</th>
      <td>512</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0</td>
      <td>1.384420e-15</td>
      <td>1900000</td>
      <td>0.959859</td>
      <td>2.40662</td>
      <td>0.819744</td>
      <td>0.974073</td>
    </tr>
    <tr>
      <th>19</th>
      <td>512</td>
      <td>4</td>
      <td>0.666667</td>
      <td>4</td>
      <td>-7.718180e-01</td>
      <td>2000000</td>
      <td>0.958547</td>
      <td>2.52695</td>
      <td>0.809699</td>
      <td>0.972554</td>
    </tr>
    <tr>
      <th>20</th>
      <td>512</td>
      <td>1</td>
      <td>0.666667</td>
      <td>1</td>
      <td>-6.057400e-04</td>
      <td>2100000</td>
      <td>0.961256</td>
      <td>2.65330</td>
      <td>0.809969</td>
      <td>0.975367</td>
    </tr>
    <tr>
      <th>21</th>
      <td>512</td>
      <td>5</td>
      <td>0.666667</td>
      <td>5</td>
      <td>-3.437480e-02</td>
      <td>2200000</td>
      <td>0.960169</td>
      <td>2.78596</td>
      <td>0.815912</td>
      <td>0.974606</td>
    </tr>
    <tr>
      <th>22</th>
      <td>512</td>
      <td>3</td>
      <td>0.666667</td>
      <td>3</td>
      <td>-5.451660e-03</td>
      <td>2300000</td>
      <td>0.961779</td>
      <td>2.92526</td>
      <td>0.808622</td>
      <td>0.972667</td>
    </tr>
    <tr>
      <th>23</th>
      <td>512</td>
      <td>2</td>
      <td>0.666667</td>
      <td>2</td>
      <td>-2.422960e-03</td>
      <td>2400000</td>
      <td>0.962746</td>
      <td>3.07152</td>
      <td>0.810340</td>
      <td>0.974888</td>
    </tr>
    <tr>
      <th>24</th>
      <td>512</td>
      <td>2</td>
      <td>0.666667</td>
      <td>2</td>
      <td>-1.503260e-02</td>
      <td>2500000</td>
      <td>0.959742</td>
      <td>3.22510</td>
      <td>0.818184</td>
      <td>0.974681</td>
    </tr>
    <tr>
      <th>25</th>
      <td>512</td>
      <td>2</td>
      <td>0.666667</td>
      <td>2</td>
      <td>-2.422960e-03</td>
      <td>2600000</td>
      <td>0.960161</td>
      <td>3.38635</td>
      <td>0.807131</td>
      <td>0.973152</td>
    </tr>
    <tr>
      <th>26</th>
      <td>512</td>
      <td>2</td>
      <td>0.666667</td>
      <td>2</td>
      <td>-9.090490e-03</td>
      <td>2700000</td>
      <td>0.959292</td>
      <td>3.55567</td>
      <td>0.807801</td>
      <td>0.973794</td>
    </tr>
    <tr>
      <th>27</th>
      <td>512</td>
      <td>5</td>
      <td>0.666667</td>
      <td>5</td>
      <td>-1.912520e-01</td>
      <td>2800000</td>
      <td>0.960460</td>
      <td>3.73346</td>
      <td>0.808358</td>
      <td>0.972796</td>
    </tr>
    <tr>
      <th>28</th>
      <td>512</td>
      <td>3</td>
      <td>0.666667</td>
      <td>3</td>
      <td>-5.451660e-03</td>
      <td>2900000</td>
      <td>0.957076</td>
      <td>3.92013</td>
      <td>0.803890</td>
      <td>0.973487</td>
    </tr>
    <tr>
      <th>29</th>
      <td>512</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0</td>
      <td>2.938730e-15</td>
      <td>3000000</td>
      <td>0.958351</td>
      <td>3.92013</td>
      <td>0.813740</td>
      <td>0.972837</td>
    </tr>
    <tr>
      <th>30</th>
      <td>512</td>
      <td>4</td>
      <td>0.666667</td>
      <td>4</td>
      <td>-8.477300e-02</td>
      <td>3100000</td>
      <td>0.960746</td>
      <td>3.92013</td>
      <td>0.810114</td>
      <td>0.973426</td>
    </tr>
    <tr>
      <th>31</th>
      <td>512</td>
      <td>3</td>
      <td>0.666667</td>
      <td>3</td>
      <td>-5.111030e-02</td>
      <td>3200000</td>
      <td>0.959443</td>
      <td>3.92013</td>
      <td>0.809371</td>
      <td>0.972671</td>
    </tr>
    <tr>
      <th>32</th>
      <td>512</td>
      <td>4</td>
      <td>0.666667</td>
      <td>4</td>
      <td>-1.888940e-02</td>
      <td>3300000</td>
      <td>0.960484</td>
      <td>3.92013</td>
      <td>0.817021</td>
      <td>0.974802</td>
    </tr>
    <tr>
      <th>33</th>
      <td>512</td>
      <td>5</td>
      <td>0.666667</td>
      <td>5</td>
      <td>-7.675900e-02</td>
      <td>3400000</td>
      <td>0.960333</td>
      <td>3.92013</td>
      <td>0.811470</td>
      <td>0.973263</td>
    </tr>
    <tr>
      <th>34</th>
      <td>512</td>
      <td>2</td>
      <td>0.666667</td>
      <td>2</td>
      <td>-2.422960e-03</td>
      <td>3500000</td>
      <td>0.956996</td>
      <td>3.92013</td>
      <td>0.810501</td>
      <td>0.973758</td>
    </tr>
    <tr>
      <th>35</th>
      <td>512</td>
      <td>2</td>
      <td>0.666667</td>
      <td>2</td>
      <td>-8.007440e-03</td>
      <td>3600000</td>
      <td>0.957236</td>
      <td>3.92013</td>
      <td>0.810391</td>
      <td>0.970764</td>
    </tr>
    <tr>
      <th>36</th>
      <td>512</td>
      <td>3</td>
      <td>0.666667</td>
      <td>3</td>
      <td>-1.703660e-02</td>
      <td>3700000</td>
      <td>0.958981</td>
      <td>3.92013</td>
      <td>0.810042</td>
      <td>0.973365</td>
    </tr>
    <tr>
      <th>37</th>
      <td>512</td>
      <td>3</td>
      <td>0.666667</td>
      <td>3</td>
      <td>-5.451660e-03</td>
      <td>3800000</td>
      <td>0.958747</td>
      <td>3.92013</td>
      <td>0.811072</td>
      <td>0.973529</td>
    </tr>
    <tr>
      <th>38</th>
      <td>512</td>
      <td>5</td>
      <td>0.666667</td>
      <td>5</td>
      <td>-9.325220e-01</td>
      <td>3900000</td>
      <td>0.959826</td>
      <td>3.92013</td>
      <td>0.806793</td>
      <td>0.974802</td>
    </tr>
    <tr>
      <th>39</th>
      <td>512</td>
      <td>2</td>
      <td>0.666667</td>
      <td>2</td>
      <td>-2.422960e-03</td>
      <td>4000000</td>
      <td>0.955633</td>
      <td>3.92013</td>
      <td>0.802321</td>
      <td>0.971774</td>
    </tr>
    <tr>
      <th>40</th>
      <td>512</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0</td>
      <td>5.693470e-15</td>
      <td>4100000</td>
      <td>0.957031</td>
      <td>3.92013</td>
      <td>0.812522</td>
      <td>0.973019</td>
    </tr>
    <tr>
      <th>41</th>
      <td>512</td>
      <td>3</td>
      <td>0.666667</td>
      <td>3</td>
      <td>-5.451660e-03</td>
      <td>4200000</td>
      <td>0.955650</td>
      <td>3.92013</td>
      <td>0.816567</td>
      <td>0.974528</td>
    </tr>
    <tr>
      <th>42</th>
      <td>512</td>
      <td>1</td>
      <td>0.666667</td>
      <td>1</td>
      <td>-6.057400e-04</td>
      <td>4300000</td>
      <td>0.957876</td>
      <td>3.92013</td>
      <td>0.813307</td>
      <td>0.973914</td>
    </tr>
    <tr>
      <th>43</th>
      <td>512</td>
      <td>5</td>
      <td>0.666667</td>
      <td>5</td>
      <td>-8.650470e-02</td>
      <td>4400000</td>
      <td>0.952871</td>
      <td>3.92013</td>
      <td>0.807906</td>
      <td>0.969968</td>
    </tr>
    <tr>
      <th>44</th>
      <td>512</td>
      <td>1</td>
      <td>0.666667</td>
      <td>1</td>
      <td>-6.057400e-04</td>
      <td>4500000</td>
      <td>0.957745</td>
      <td>3.92013</td>
      <td>0.816832</td>
      <td>0.973855</td>
    </tr>
    <tr>
      <th>45</th>
      <td>512</td>
      <td>4</td>
      <td>0.666667</td>
      <td>4</td>
      <td>-7.577050e-02</td>
      <td>4600000</td>
      <td>0.958625</td>
      <td>3.92013</td>
      <td>0.810424</td>
      <td>0.974554</td>
    </tr>
    <tr>
      <th>46</th>
      <td>512</td>
      <td>1</td>
      <td>0.666667</td>
      <td>1</td>
      <td>-6.057400e-04</td>
      <td>4700000</td>
      <td>0.959379</td>
      <td>3.92013</td>
      <td>0.814087</td>
      <td>0.973287</td>
    </tr>
    <tr>
      <th>47</th>
      <td>512</td>
      <td>3</td>
      <td>0.666667</td>
      <td>3</td>
      <td>-2.016440e-02</td>
      <td>4800000</td>
      <td>0.957857</td>
      <td>3.92013</td>
      <td>0.809035</td>
      <td>0.974121</td>
    </tr>
    <tr>
      <th>48</th>
      <td>512</td>
      <td>3</td>
      <td>0.666667</td>
      <td>3</td>
      <td>-1.332040e-01</td>
      <td>4900000</td>
      <td>0.956279</td>
      <td>3.92013</td>
      <td>0.814676</td>
      <td>0.975094</td>
    </tr>
    <tr>
      <th>49</th>
      <td>512</td>
      <td>5</td>
      <td>0.666667</td>
      <td>5</td>
      <td>-7.386550e-02</td>
      <td>5000000</td>
      <td>0.958636</td>
      <td>3.92013</td>
      <td>0.808721</td>
      <td>0.974890</td>
    </tr>
    <tr>
      <th>50</th>
      <td>512</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0</td>
      <td>-4.867530e-15</td>
      <td>5100000</td>
      <td>0.958584</td>
      <td>3.92013</td>
      <td>0.807197</td>
      <td>0.973241</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Note that states are index integer values starting from 0 (e.g., 0, 1, 2, …, criteria.num_states() - 1) The state and macrostate happen to be the same when the minimum macrostate is 0, and the macrostate is the integer number of particles. But if the minimum macrostate was 1, then state 0 would correspond to macrostate 1.0. Obtain an arbitrary macrostate value from the state as follows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">monte_carlo</span> <span class="o">=</span> <span class="n">fst</span><span class="o">.</span><span class="n">MonteCarlo</span><span class="p">()</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">pyfeasst</span><span class="o">.</span><span class="n">read_checkpoint</span><span class="p">(</span><span class="s2">&quot;checkpoint.txt&quot;</span><span class="p">))</span>
<span class="n">criteria</span> <span class="o">=</span> <span class="n">fst</span><span class="o">.</span><span class="n">FlatHistogram</span><span class="p">(</span><span class="n">monte_carlo</span><span class="o">.</span><span class="n">criteria</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;state macrostate&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">num_states</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">criteria</span><span class="o">.</span><span class="n">macrostate</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
state macrostate
0 0.0
1 1.0
2 2.0
3 3.0
4 4.0
5 5.0
</pre></div></div>
</div>
<p>Many simulation parameters may be obtained from the checkpoint file to automate your analysis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="n">monte_carlo</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">volume</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">monte_carlo</span><span class="o">.</span><span class="n">thermo_params</span><span class="p">()</span><span class="o">.</span><span class="n">beta</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;beta_mu&#39;</span><span class="p">,</span> <span class="n">monte_carlo</span><span class="o">.</span><span class="n">thermo_params</span><span class="p">()</span><span class="o">.</span><span class="n">beta_mu</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;macro_min&#39;</span><span class="p">,</span> <span class="n">criteria</span><span class="o">.</span><span class="n">macrostate</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># monte_carlo.critera() doesn&#39;t know macrostate. Use copy of derived class</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;macro_max&#39;</span><span class="p">,</span> <span class="n">criteria</span><span class="o">.</span><span class="n">macrostate</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">num_states</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;macro_max&#39;</span><span class="p">,</span> <span class="n">criteria</span><span class="o">.</span><span class="n">macrostate</span><span class="p">()</span><span class="o">.</span><span class="n">histogram</span><span class="p">()</span><span class="o">.</span><span class="n">center_of_last_bin</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
volume 512.0
beta 0.6666666666666666
beta_mu -1.5682139999999998
macro_min 0.0
macro_max 5.0
macro_max 5.0
</pre></div></div>
</div>
<p>The energy of each macrostate may also be compared with the published values in the NIST SRSW.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">en</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;lj_en.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;average&quot;</span><span class="p">:</span> <span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;block_stdev&quot;</span><span class="p">:</span> <span class="s2">&quot;u_std&quot;</span><span class="p">})</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">en</span><span class="p">[[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;u_std&quot;</span><span class="p">]]),</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;u_srsw&quot;</span><span class="p">,</span> <span class="s2">&quot;u_srsw_std&quot;</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>u</th>
      <th>u_std</th>
      <th>u_srsw</th>
      <th>u_srsw_std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.362240e-17</td>
      <td>3.496062e-16</td>
      <td>-2.312265e-10</td>
      <td>6.689238e-10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-6.057400e-04</td>
      <td>2.174108e-12</td>
      <td>-6.057402e-04</td>
      <td>6.709198e-10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-3.022146e-02</td>
      <td>1.914936e-04</td>
      <td>-3.057422e-02</td>
      <td>9.649147e-06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-8.944287e-02</td>
      <td>6.205232e-04</td>
      <td>-8.992832e-02</td>
      <td>1.387472e-04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.776325e-01</td>
      <td>1.183672e-03</td>
      <td>-1.784571e-01</td>
      <td>3.315245e-05</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-2.975943e-01</td>
      <td>1.263983e-03</td>
      <td>-2.961920e-01</td>
      <td>1.348791e-05</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>You may also compare the natural logarithm of the macrostate probability</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ln_prob_srsw&quot;</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;lj_fh.txt&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;ln_prob&#39;</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ln_prob_srsw</th>
      <th>ln_prob</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-18.707570</td>
      <td>-18.708853</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-14.037373</td>
      <td>-14.036188</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-10.050312</td>
      <td>-10.047908</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-6.458921</td>
      <td>-6.456178</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-3.145637</td>
      <td>-3.143491</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.045677</td>
      <td>-0.045779</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The macrostate probability distribution depends upon the choice of the chemical potential, but can be reweighted to different chemical potentials. The collection matrix may be accessed directly as:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tm</span> <span class="o">=</span> <span class="n">fst</span><span class="o">.</span><span class="n">TransitionMatrix</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">bias</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">collection</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((0.0, 490658.0, 327110.0), (3069.581954269688, 491835.8487120219, 326024.5693312088), (6104.062418983776, 495331.5028214753, 328145.43476144026), (9169.333423416996, 501944.48620484327, 330625.1803712205), (12160.1071825707, 506374.6668414039, 331579.22597497044), (16547.69186126913, 558631.3134046715, 364688.9947327478))
</pre></div></div>
</div>
<p>Did this tutorial work as expected? Did you find any inconsistencies or have any comments? Please <a class="reference internal" href="../../../CONTACT.html"><span class="doc">contact</span></a> us. Any feedback is appreciated!</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="tutorial_2_reweight_supercritical.html" class="btn btn-neutral float-right" title="Analysis of a one-phase (supercritical) simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="tutorial_10_hs.html" class="btn btn-neutral float-left" title="Analysis of a hard sphere simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


	<br></br>
	<footer class="nist-footer">
  <div class="nist-footer__inner">
    <div class="nist-footer__menu" role="navigation">
      <ul>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy-policy">Privacy Statement</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy-policy#privpolicy">Privacy Policy</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy-policy#secnot">Security Notice</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy-policy#accesstate">Accessibility Statement</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy">NIST Privacy Program</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/no-fear-act-policy">No Fear Act Policy</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/disclaimer">Disclaimer</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/office-director/freedom-information-act">FOIA</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/environmental-policy-statement">Environmental Policy Statement</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy-policy#cookie">Cookie Disclaimer</a>
        </li>
        <li class="nist-footer__menu-item ">
          <a href="https://www.nist.gov/summary-report-scientific-integrity">Scientific Integrity Summary</a>
        </li>
        <li class="nist-footer__menu-item ">
          <a href="https://www.nist.gov/nist-information-quality-standards">NIST Information Quality Standards</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://business.usa.gov/">Business USA</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.commerce.gov/">Commerce.gov</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.healthcare.gov/">Healthcare.gov</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="http://www.science.gov/">Science.gov</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="http://www.usa.gov/">USA.gov</a>
        </li>
      </ul>
    </div>
  </div>
  <div class="nist-footer__logo">
    <a href="https://www.nist.gov/" title="National Institute of Standards and Technology" class="nist-footer__logo-link" rel="home">
      <img src="https://pages.nist.gov/nist-header-footer/images/nist_logo_centered_rev.svg" alt="National Institute of Standards and Technology logo" />
    </a>
  </div>
</footer>

  <!-- Global site tag (gtag.js) - Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-115121490-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-115121490-6');
  </script>



</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>